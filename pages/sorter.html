---
layout: default
category: archive
title: 乃木坂46 Sorter
---

<style>

  .tag-grid {
    justify-content: center;
    grid-template-columns: auto auto;
  }

  .button1 {
    margin-right: 10px;
  }

  .button2 {
    margin-left: 10px;
  }

  .button1, .tag-grid button {
    display: block;
    width: 200px;
    height: auto;
    margin: 20px auto;
    color: blue;
    font-family: "MS PGothic", "Courier", "Lucida Console", "Menlo Regular", "IBM Plex Mono", "Fira Code", "Fira Mono","Roboto Mono","Droid Sans Mono", Monaco, Consolas, Courier, monospace;;
    text-align: center;
    padding: 15px;
    transition-duration: 0.4s;
    overflow: hidden;
    border-color: blue;
    border-style: solid;
    border-width: thin;
    background-color: white;
    cursor: pointer;
  }
  
  .button1:hover, .tag-grid button:hover {
    border-style: 1px thin purple;
  }
  
  .names {
    clear: both;
    margin-top: 3em;
    margin-bottom: 1rem;
    color: black;
    margin-left: 30px;
  }
  
  </style>

<div class="leftcolumn">
  {% include profile-card.html %}
</div>

<div class="midcolumn">
  <div class="index-card">
    <br>
    <div class="side-card">
    </div>
    <br>
    <div id="counter" style="font-weight: bold; margin: 10px 0;">0%</div>
    <div class="tag-grid">
      <button id="start" onclick="startSorting()">Start Sorting</button>
      <button id="button1" onclick="choose(1)">Loading...</button>
      <button id="button2" onclick="choose(2)">Loading...</button>
      <button id="retry" style="display: none;" onclick="initialize()">Try Again</button>
    </div>

    <div id="names"></div>

    {% include license.html %}

<script>
  var names = ["IOKI MAO", "IKEDA TERESA", "ICHINOSE MIKU", "INOUE NAGI",
    "OGAWA AYA", "OKUDA IROHA", "KAWASAKI SAKURA", "SUGAWARA SATSUKI", "TOMISATO NAO",
    "NAKANISHI ARUNO", "OKAMOTO HINA"];

  var comparisons = {};
  var queue = [];
  var activePair = null;
  var totalPairs = 0;

  function startSorting() {
    document.getElementById('start').style.display = "none";
    mergeSort(names, 0, names.length - 1);

    // Calculate the total number of pairs
    totalPairs = names.length * (names.length - 1) / 2;

    processQueue();
  }

  function mergeSort(arr, left, right) {
    if (left < right) {
      var mid = left + Math.floor((right - left) / 2);
      mergeSort(arr, left, mid);
      mergeSort(arr, mid + 1, right);
      merge(arr, left, mid, right);
    }
  }

  function merge(arr, left, mid, right) {
    var i = left;
    var j = mid + 1;
    var temp = [];
    var pairsProcessed = 0; // Added a variable to keep track of pairs processed in this merge operation.
    
    while (i <= mid && j <= right) {
      if (comparisons[arr[i] + '-' + arr[j]]) {
        if (comparisons[arr[i] + '-' + arr[j]] === arr[i]) {
          temp.push(arr[i++]);
        } else {
          temp.push(arr[j++]);
        }
      } else {
        queue.push([arr[i], arr[j], temp, arr, i, j, mid, right]);
        return;
      }
      
      pairsProcessed++; // Increment the counter for each pair processed.
    }
    while (i <= mid) {
      temp.push(arr[i++]);
    }
    while (j <= right) {
      temp.push(arr[j++]);
    }
    for (var k = left; k <= right; k++) {
      arr[k] = temp[k - left];
    }
  }

  function processQueue() {
    if (queue.length > 0) {
      activePair = queue.shift();
      document.getElementById('button1').style.cssText = "display: block; margin-right: 10px;";
      document.getElementById('button1').textContent = activePair[0];
      document.getElementById('button2').style.cssText = "display: block; margin-left: 10px;";
      document.getElementById('button2').textContent = activePair[1];

      // Update the counter
      var completedPairs = totalPairs - queue.length + pairsProcessed;
      var percentage = Math.round((completedPairs / totalPairs) * 100);
      document.getElementById('counter').textContent = percentage + "%";
    } else {
      finishSorting();
    }
  }

  function choose(index) {
    var name1 = document.getElementById('button1').textContent;
    var name2 = document.getElementById('button2').textContent;
    if (index === 1) {
      comparisons[name1 + '-' + name2] = name1;
      comparisons[name2 + '-' + name1] = name1;
      activePair[2].push(activePair[0]);
      activePair[4]++;
    } else {
      comparisons[name1 + '-' + name2] = name2;
      comparisons[name2 + '-' + name1] = name2;
      activePair[2].push(activePair[1]);
      activePair[5]++;
    }
    document.getElementById('button1').style.display = "none";
    document.getElementById('button2').style.display = "none";
    merge(activePair[3], activePair[4], activePair[6], activePair[7]);
    processQueue();
  }

  function finishSorting() {
    var result = names.map((name, index) => {
      var rank = index + 1;
      if (rank === 1) {
        return `<span style="color:blue;">${rank}. ${name}</span>`;
      } else if (rank === 2) {
        return `<span style="color:blue;">${rank}. ${name}</span>`;
      } else if (rank === 3) {
        return `<span style="color:blue;">${rank}. ${name}</span>`;
      } else {
        return `${rank}. ${name}`;
      }
    }).join("<br>");
    document.getElementById('names').innerHTML = result;
    document.getElementById('retry').style.display = "block";
    document.getElementById('counter').textContent = "100%"; // Set the counter to 100% after completion.
  }

  function initialize() {
    document.getElementById('start').style.display = "block";
    document.getElementById('button1').style.display = "none";
    document.getElementById('button2').style.display = "none";
    document.getElementById('retry').style.display = "none";
    document.getElementById('names').innerHTML = "";
    comparisons = {};
    queue = [];
    activePair = null;

    // Fisher-Yates shuffle algorithm
    for (var i = names.length - 1; i > 0; i--) {
      var j = Math.floor(Math.random() * (i + 1));
      var temp = names[i];
      names[i] = names[j];
      names[j] = temp;
    }
  }

  initialize();

  document.body.addEventListener('keydown', function (event) {
    if (event.key === 'a' || event.key === 'A') {
      choose(1);
    } else if (event.key === 'd' || event.key === 'D') {
      choose(2);
    }
  });

</script>

